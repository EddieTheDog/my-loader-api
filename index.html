<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loader API v1</title>
    <style>
        :root { --accent: #38bdf8; --bg: #0f172a; --card: #1e293b; }
        body { margin: 0; background: var(--bg); color: white; font-family: sans-serif; display: flex; flex-direction: column; align-items: center; min-height: 100vh; }
        #preview { height: 250px; width: 100%; display: flex; align-items: center; justify-content: center; background: radial-gradient(circle, #1e293b 0%, #0f172a 100%); border-bottom: 1px solid #334155; }
        .container { max-width: 700px; width: 90%; padding: 40px 0; }
        .card { background: var(--card); padding: 30px; border-radius: 16px; border: 1px solid #334155; }
        h1 { margin: 0; color: var(--accent); text-transform: capitalize; }
        .url-box { background: #000; padding: 12px; border-radius: 8px; display: flex; align-items: center; gap: 10px; border: 1px solid var(--accent); margin: 20px 0; }
        #url-display { font-family: monospace; color: #f472b6; flex-grow: 1; overflow: hidden; text-overflow: ellipsis; }
        .prop-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px; }
        .prop-card { background: rgba(0,0,0,0.2); padding: 15px; border-radius: 10px; border: 1px solid rgba(255,255,255,0.05); }
        .prop-card b { color: var(--accent); display: block; margin-bottom: 5px; font-size: 0.8rem; }
        button { background: var(--accent); border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; font-weight: bold; }
        
        /* Loader Styles */
        .api-spinner { width: var(--sz); height: var(--sz); border: 5px solid rgba(255,255,255,0.1); border-top-color: var(--clr); border-radius: 50%; animation: spin var(--sp) linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
    </style>
</head>
<body>

    <div id="preview">
        <div id="mount"></div>
    </div>

    <div class="container">
        <div id="doc-card" class="card" style="display:none;">
            <h1 id="title">Loader</h1>
            <p>Direct URL/API access for this component.</p>
            
            <div class="url-box">
                <span id="url-display"></span>
                <button onclick="copyURL()">Copy URL</button>
            </div>

            <div class="prop-grid" id="prop-list"></div>
        </div>

        <div id="home-card" class="card" style="display:none; text-align:center;">
            <h1>Loader Library</h1>
            <p>Visit <code>/spinner</code> or <code>/ripple</code> to see properties.</p>
        </div>
    </div>

    <script>
        // Use a single script to prevent "Uncaught ReferenceError"
        window.LoaderAPI = {
            render: function(c) {
                const m = document.getElementById('mount');
                if(!m) return;
                m.style.setProperty('--clr', c.color || '#38bdf8');
                m.style.setProperty('--sz', c.size || '60px');
                m.style.setProperty('--sp', c.speed || '1s');
                m.innerHTML = `<div class="api-${c.type}"></div>`;
            }
        };

        window.addEventListener('DOMContentLoaded', () => {
            const path = window.location.pathname.replace(/\//g, '').toLowerCase();
            const urlDisplay = document.getElementById('url-display');
            if(urlDisplay) urlDisplay.innerText = window.location.href;

            const registry = {
                'spinner': ['color', 'size', 'speed'],
                'ripple': ['color', 'size']
            };

            if (registry[path]) {
                document.getElementById('doc-card').style.display = 'block';
                document.getElementById('title').innerText = path;
                
                const list = document.getElementById('prop-list');
                registry[path].forEach(p => {
                    const d = document.createElement('div');
                    d.className = 'prop-card';
                    d.innerHTML = `<b>${p}</b> Editable via URL <code>?${p}=value</code>`;
                    list.appendChild(d);
                });

                const p = new URLSearchParams(window.location.search);
                LoaderAPI.render({
                    type: path,
                    color: p.get('color') ? '#' + p.get('color') : '#38bdf8',
                    size: p.get('size') || '60px',
                    speed: p.get('speed') || '1s'
                });
            } else {
                document.getElementById('home-card').style.display = 'block';
            }
        });

        function copyURL() {
            navigator.clipboard.writeText(window.location.href);
            alert('URL Copied!');
        }
    </script>
</body>
</html>
